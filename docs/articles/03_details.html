<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="noaastormevents">
<title>Details • noaastormevents</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Details">
<meta property="og:description" content="noaastormevents">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">noaastormevents</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/noaastormevents.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01_find_events.html">Finding storm events</a>
    <a class="dropdown-item" href="../articles/02_map_events.html">Mapping storm events</a>
    <a class="dropdown-item" href="../articles/03_details.html">Details</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/geanders/noaastormevents/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Details</h1>
                        <h4 data-toc-skip class="author">Brooke
Anderson, Ziyu Chen, and Jordan Robinson</h4>
            
            <h4 data-toc-skip class="date">2023-08-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/geanders/noaastormevents/blob/HEAD/vignettes/03_details.Rmd" class="external-link"><code>vignettes/03_details.Rmd</code></a></small>
      <div class="d-none name"><code>03_details.Rmd</code></div>
    </div>

    
    
<pre><code><span><span class="co">## Note: Examples in this vignette are set to not run on CRAN. If you</span></span>
<span><span class="co">## would like to build this vignette locally, you can do so by first</span></span>
<span><span class="co">## setting the environmental variable 'NOT_CRAN' to 'true' on your</span></span>
<span><span class="co">## computer and then rebuilding the vignette.</span></span></code></pre>
<p>This vignette provides more details on how the
<code>noaastormevents</code> package interacts with the online NOAA
Storm Events database to pull storm event listings based on user
queries.</p>
<div class="section level2">
<h2 id="structure-of-noaa-storm-events-data">Structure of NOAA Storm Events data<a class="anchor" aria-label="anchor" href="#structure-of-noaa-storm-events-data"></a>
</h2>
<p>The NOAA Storm Events data is available online at <a href="https://www.ncdc.noaa.gov/stormevents/" class="external-link uri">https://www.ncdc.noaa.gov/stormevents/</a>. That website
includes documentation on the data, as well as a page that allows bulk
data download of yearly csv files either through ftp or http (<a href="https://www.ncdc.noaa.gov/stormevents/ftp.jsp" class="external-link uri">https://www.ncdc.noaa.gov/stormevents/ftp.jsp</a>). Data is
available from January 1950 and tends to be updated to within a few
months of present.</p>
<p>Data is stored in bulk by year in compressed comma-separated files
(<code>.csv.gz</code> files). Each year has three compressed files
available:</p>
<ul>
<li>
<code>StormEvents_details</code> file</li>
<li>
<code>StormEvents_fatalities</code> file</li>
<li>
<code>StormEvents_loations</code> file</li>
</ul>
<p>File names for each file include both the year of the data (e.g.,
“1950”) and the date the file was last modified (e.g., “20170120”).
Files are given regular names other than these two specifications. This
regular naming scheme allows us to use regular expressions in code
within the <code>noaastormevents</code> package on all listed file names
to identify the exact name of a file for a specific year, as explained
in the next section.</p>
<p>The size of all three file types has increased with time (see figure
below; note that the y-axis is log 10). The largest file for any given
year is the “Details” file. Most file sizes increased substantially in
1996 (dotted vertical line), when the database dramatically expanded the
types of events it included. Before 1996, the database covered tornadoes
and, for some years, a few other types of events. From 1996, the
database expanded to include events like floods, tropical storms, snow
storms, etc. While “Locations” files exist in the database for early
years, they contain no information until 1996. See the documentation at
the NOAA Storm Events database website for more information on the
coverage of the database at different times across its history.</p>
</div>
<div class="section level2">
<h2 id="downloading-noaa-storm-events-data-for-a-year">Downloading NOAA Storm Events data for a year<a class="anchor" aria-label="anchor" href="#downloading-noaa-storm-events-data-for-a-year"></a>
</h2>
<p>The database data is stored in files separated by year, so the file
for an entire year is identified and downloaded when a user asks for
event listings from any time or any type of event that year. For
example, if a user wants to list flood events from the week of Hurricane
Floyd in 1999, functions in the <code>noaastormevents</code> package
would first identify and download the full “Details” data file for 1999
and then filter down to flood events starting in the correct week.</p>
<p>To identify the online file path for a specific year, the
<code>find_file_name</code> function in the <code>noaastormevents</code>
package uses the <code>htmltab</code> function (from the package of the
same name) to create a dataframe listing all files available for
download from the NOAA Storm Events database. The function then uses
regular expressions to identify the file name in that listing for the
requested year. For example, the name of the file with “Details”
information for 1999 can be determined with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/find_file_name.html">find_file_name</a></span><span class="op">(</span>year <span class="op">=</span> <span class="st">"1999"</span>, file_type <span class="op">=</span> <span class="st">"detail"</span><span class="op">)</span></span></code></pre></div>
<p>Here is the full definition of the <code>find_file_name</code>
function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">find_file_name</span></span></code></pre></div>
<p>Typically, this function will only be used internally rather than
called directly by a user.</p>
<p>Once the file name has been determined, a function in the package
then downloads that file to the user’s computer. For some years, files
are very large, so this download can take a little while. To avoid
downloading data from the same year more than once within an R session,
the downloading function stores the downloaded data for that year in a
temporary environment in the R user’s session. In later requests for the
same year, the function will first check for data from this year in the
temporary environment and only download the data from the online
database if it is not already available on the user’s computer.</p>
<p>This environment is created to be temporary, which means that it is
deleted at the end of the current R session. While some packages that
access online databases cache any downloaded data in a way that persists
between R sessions, we chose not to do that and instead only cache
within an R session, but delete all data at the close of the R session.
This is because some of the Storm Event files are very large, and most
users will likely only want to keep a small subset of the data for a
given year (e.g., only flood events during the week of Hurricane Floyd).
It would be wasteful of memory to cache all the 1999 data indefinitely
on the user’s computer in this case; instead, the user should use our
package to create the desired subset of the data and then explicitly
store that subset locally to use in future analysis.</p>
<p>The function for downloading the file for a year is called
<code>download_storm_data</code>. Here is it’s full definition:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">noaastormevents</span><span class="fu">:::</span><span class="va"><a href="../reference/download_storm_data.html">download_storm_data</a></span></span></code></pre></div>
<p>Finally, the <code>noaastormevents</code> package allows a user to
query storm events either by a date range or by a named historical
tropical storm, rather than a year. The <code>create_storm_data</code>
function inputs either a date range or a storm name, as well as the
requested file type, and downloads data for the appropriate year or
years. If the user requests a date range, the function will download
yearly data files for all years included in that range. If the user
requests a tropical storm, the function will pull the data for that
particular year. Here is the full definition of
<code>create_storm_data</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">create_storm_data</span></span></code></pre></div>
<p>As a note, many of the functions in the <code>noaastormevents</code>
package that allow linking events with tropical storms rely on
historical data for the storms, including storm tracks, estimated
distances to eastern U.S. counties, and dates when the storm was closest
to each county. The package pulls this historical data from the
<code>hurricaneexposuredata</code> package, through the interfacing
package <code>hurricaneexposure</code>. The hurricane data goes from
1988 to (currently) 2015 and includes all Atlantic basin tropical storms
that came within 250 km of at least one U.S. county. The following
storms are included in that package and so available to be used for
functions in <code>noaastormevents</code>:</p>
</div>
<div class="section level2">
<h2 id="structure-of-details-data-files">Structure of “Details” data files<a class="anchor" aria-label="anchor" href="#structure-of-details-data-files"></a>
</h2>
<p>While the <code>noaastormevent</code> package focuses on higher-level
functions, which result in a simplified and cleaned version of this
storm events data, a user can use the <code>create_storm_data</code>
function to pull the full dataset for a year into R and work with the
raw, uncleaned version. For example, here is a call that pulls the raw
data for 2015 into an R object called <code>events_2015</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">events_2015</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_storm_data.html">create_storm_data</a></span><span class="op">(</span>date_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2015-01-01"</span>, <span class="st">"2015-12-31"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="va">events_2015</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>This raw data has 51 columns. This includes:</p>
<ul>
<li>the date and time of the beginning and end of the event
(<code>BEGIN_YEARMONTH</code>, <code>BEGIN_DAY</code>,
<code>BEGIN_TIME</code>, <code>BEGIN_DATE_TIME</code>,
<code>END_YEARMONTH</code>, <code>END_DAY</code>, <code>END_TIME</code>,
<code>END_DATE_TIME</code>)</li>
<li>unique IDs for the event and the episode, which can be used to link
listings for events and episodes across the three types of files
(“details”, “locations”, and “fatalities”) (<code>EPISODE_ID</code>,
<code>EVENT_ID</code>). Note that there are more unique event IDs
(57,779 for the 2015 events data) than unique episode IDs (9,511 for the
2015 events data)</li>
<li>the type of event (<code>EVENT_TYPE</code>)</li>
<li>the location of the event (<code>CZ_TYPE</code>,
<code>CZ_FIPS</code>, <code>CZ_NAME</code>, <code>BEGIN_AZIMUTH</code>,
<code>BEGIN_LOCATION</code>, <code>END_LOCATION</code>,
<code>END_AZIMUTH</code>, <code>BEGIN_LAT</code>,
<code>BEGIN_LON</code>, <code>END_LAT</code>, <code>END_LON</code>)</li>
<li>description and impacts of the event
(<code>EPISODE_NARRATIVE</code>, <code>EVENT_NARRATIVE</code>,
<code>INJURIES_DIRECT</code>, <code>INJURIES_INDIRECT</code>,
<code>DEATHS_DIRECT</code>, <code>DEATHS_INDIRECT</code>,
<code>DAMAGE_PROPERTY</code>, <code>DAMAGE_CROPS</code>)</li>
<li>information on how the event was reported (<code>SOURCE</code>)</li>
<li>some metrics that are specific to event types (e.g.,
<code>FLOOD_CAUSE</code>, <code>CATEGORY</code>,
<code>TOR_F_SCALE</code>, <code>TOR_LENGTH</code>,
<code>TOR_WIDTH</code>)</li>
</ul>
<div class="section level3">
<h3 id="event-types">Event types<a class="anchor" aria-label="anchor" href="#event-types"></a>
</h3>
<p>The following sections provide some summary statistics for data from
this database for a single year (2015), to help users better understand
the available data. Users may want to conduct similar data analysis
themselves with the set of data they pull from the NOAA Storm Events
database relevant to a particular research project. The code from this
vignette (available at the package’s GitHub repository) can serve as a
starting point for that.</p>
<p>In the 2015 event listings, here are the types of events and the
number of reported events for each:</p>
<p>Here are how the start dates for listings for each event type are
distributed over the year (event types are ordered by decreasing total
count during the year; note that the y-axes vary depending on the range
of events by date for each event type):</p>
<p>Many event types are clearly seasonal (e.g., winter weather, winter
storms, heavy snow, cold, extreme cold, blizzards, ice storms,
lake-effect snow, and avalanches are all much more common during winter
months, while tropical depressions and tropical storms are all limited
to the hurricane season). However, for some events, reporting seasonal
patterns might be based not just on the true pattern of events but also
on the timing of important exposures and impacts of the events. For
example, rip currents have many more listings during the spring and
summer, which may be related to events being more likely to be listed
when more people are swimming. Frost event listings are particularly
high at the start and end of the frost season, rather than in the middle
of winter, which may be related to the impacts of frost on crops being
higher in spring and fall than during the winter. If working with this
data, it important to keep in mind that the data are based on reporting,
and there may be related influences on the probability of an event being
reported and included in the data that differ from using data from
something like a weather station.</p>
</div>
<div class="section level3">
<h3 id="episodes-versus-events">Episodes versus events<a class="anchor" aria-label="anchor" href="#episodes-versus-events"></a>
</h3>
<p>“Episodes” seem to collect related “events”, where events can vary in
the type or location of the event, while an “episode” collects events
that belong to the same large system. The following graph shows, for
each episode listed in 2015, the number of events listed for the episode
(x-axis) and the size (in days) of the range of begin dates across
events in the episode.</p>
<p>An episode will never include events in more than one state, so a
large weather system could potentially be described by multiple episodes
in different states:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">events_2015</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">EPISODE_ID</span>, <span class="va">STATE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">EPISODE_ID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n_states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">STATE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>max_n_states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">n_states</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Here are maps with the beginning locations of events in the episodes
with the most events in 2015. Note that the beginning latitude and
longitude are not listed for every event, resulting in one of the
episodes not having any points on the map. From the other maps, it is
clear that events within the episode were fairly close together.</p>
<p>For these episodes with the most events in 2015, the following graph
shows the number of events reported for the episode. One of the episodes
was a winter storm, another was heavy rains and floods, while the rest
of the episodes included high winds, hail, tornadoes, rain, and / or
flooding.</p>
<p>Once we removed event types with less that 50 listings in 2015, we
did a cluster analysis of event types, to group events that are more
likely to occur together within an episode. The following plot shows the
resulting cluster structure of these event types.</p>
<p>The next graph shows the number of events of each event type
(excluding event types with less than 50 total listings in 2015). Each
row represents an episode.</p>
</div>
<div class="section level3">
<h3 id="how-events-are-reported">How events are reported<a class="anchor" aria-label="anchor" href="#how-events-are-reported"></a>
</h3>
<p>The <code>SOURCE</code> column of the raw data gives information on
how each event was reported.</p>
<p>The majority of events in this database, at least for 2015, were
reported by either a trained spotter or the public.</p>
<p>The following graph shows, for each type of event in 2015, the
percent reported by each source. For some types of events, reporting is
dominated by a specific source. For example, most high surf reports come
from trained spotters, while most drought reports come from drought
monitors and most tornado reports come from the NWS Storm Survey. For
other types of events, reporting sources are more diversified. Both axes
of the plot are ordered by overall frequency (i.e., overall number of
each type of event and overall number of reports from each source).</p>
</div>
<div class="section level3">
<h3 id="event-locations">Event locations<a class="anchor" aria-label="anchor" href="#event-locations"></a>
</h3>
<p>Each event has a state listed for the event (<code>STATE</code>). The
following graph gives the number of reported events in each state for
2015:</p>
<p>Note that “states” include bodies of water (e.g., specific Great
Lakes, the Hawaii waters, the Gulf of Mexico) and territories (American
Samoa, Guam, Puerto Rico, Virgin Islands).</p>
<p>For some event types, the latitude and longitude of the beginning of
the event is included with the event listing.</p>
<p>Of the 2015 events with a latitude and longitude listed for the
beginning of the event and that are in the continental U.S., here are
those locations by month:</p>
<p>Here are those locations by event type:</p>
<p>Some events have different latitudes and longitudes for the beginning
and ending locations. For example, here are maps for one state
(Arkansas) of events with different starting and ending locations:</p>
<p>Some events are reported by forecast zone (<code>CZTYPE</code> of
“Z”) rather than county (<code>CZTYPE</code> of “C”). Specific types of
events are typically either always reported for a county or always
reported for a forecast zone (see table below). Events typically
reported by county include floods (“Flash Flood”, “Flood”, “Debris
Flow”), tornado-like events (“Tornado”, “Funnel Cloud”, “Dust Devil”),
and a few other events often related to thunderstorms (“Thunderstorm
Wind”, “Hail”, “Heavy Rain”, “Lightning”). Events typically reported by
forecast zone include severe winter weather (“Winter Weather”, “Winter
Storm”, “Heavy Snow”, “Cold/Wind Chill”, “Extreme Cold/Wind Chill”,
“Blizzard”, “Frost/Freeze”, “Ice Storm”, “Sleet”, “Lake-Effect Snow”,
“Avalanche”, “Freezing Fog”), extreme heat (“Heat”, “Excessive Heat”,
“Drought”), events related to the water or coast (“Marine Thunderstorm
Wind”, “High Surf”, “Coastal Flood”, “Waterspout”, “Astronomical Low
Tide”, “Rip Current”, “Tropical Storm”, “Marine High Wind”, “Marine
Hail”, “Marine Strong Wind”, “Hurricane”, “Seiche”, “Storm Surge/Tide”,
“Tropical Depression”, “Marine Dense Fog”, “Sneakerwave”, “Tsunami”),
and a few others (“High Wind”, “Dense Fog”, “Strong Wind”, “Wildfire”,
“Dust Storm”, “Dense Smoke”).</p>
<p>For events reported by county, here are maps showing distributions in
the number of events reported in 2015:</p>
<p>Here is a sample of events that are instead reported by forecast
zone, with the state, <code>CZ_NAME</code>, and event narrative
included. Note that the county name is often provided by the
<code>CZ_NAME</code> column, although the <code>CZ_FIPS</code> value is
the forecast zone for any event listed by forecast zone. We use code to
try to match <code>STATE</code> and <code>CZ_NAME</code> listings to a
table of U.S. county names and associated county FIPS for each event
listed by forecast zone, to allow these events to be included in event
listings and maps created by functions in
<code>noaastormevents</code>.</p>
<p>Within the code in <code>noaastormevents</code>, the
<code>match_forecast_county</code> is used to try to match a county FIPS
to each of the events listed by forecast zone. To get the full code for
that function, you can run <code>match_forecast_county</code> (i.e., the
function name, without parentheses after). To match an events listed by
forecast zone to a county, this function tries the following to try to
match all or part of the <code>state_name</code> and
<code>cz_name</code> columns in the storm events data to the state and
county names in the <code>county.fips</code> dataframe that comes with
the <code>maps</code> package:</p>
<ol style="list-style-type: decimal">
<li>Tries to match <code>cz_name</code> to the county name in
<code>county.fips</code> after removing any periods or apostrophes in
<code>cz_name</code>.</li>
<li>Next, for county names with ‘county’ in them, try to match the word
before ‘county’ to county name in <code>county.fips</code>. Then check
the two words before ‘county’, then the one and two words before
‘counties’.</li>
<li>Next, pull out the last word in <code>cz_name</code> and try to
match it to the county name in <code>county.fips</code>. Then check the
last two words in <code>cz_name</code>, then check the last three words
in <code>cz_name</code>.</li>
<li>Next, pull any words right before a slash and check that against the
county name.</li>
<li>Finally, try removing anything in parentheses in
<code>cz_name</code> before matching.</li>
</ol>
<p>In addition, there are a few final steps in cleaning the data. First,
all listings with “Utah” in the <code>cz_name</code> are set to missing–
while there is a Utah County, Utah, from inspection of event listings in
2015, events in Utah with “Utah” in <code>cz_name</code> often referred
to parts of the state, rather than to the county. Further, any event
with “National Park” listed in <code>cz_name</code> is set to not match
with a county FIPS. In Wyoming, Park County was being matched to a
<code>cz_name</code> for Yellowstone National Park, and this could be a
problem in other states, so this extra check was included.</p>
<p>In the 2015 events data, there are 22,664 events listed by forecast
zone rather than county. Once the <code>match_forecast_county</code>
function is applied to these events, 16,405 events were linked to a
county (72%) while 6,259 events (28%) could not be matched to a
county.</p>
<p>Of the events not matched to a county, 2,997 events were outside the
continental U.S. (i.e., in Hawaii, Alaska, U.S. territories, or
waters):</p>
<p>This left 3,262 events in the continental U.S. that were listed by
forecast zone but could not be linked to a county by the
<code>match_forecast_county</code> function. Most of these events had a
value for <code>cz_name</code> with words related to mountains, water,
adjacency (e.g., “area of”, “vicinity of”), or a few other word types
(e.g., “desert”, “hwy”). The following table gives the number of these
remaining unmatched events with words from each of these categories
(note: the <code>cz_name</code> for an event may have words from more
than one of these categories, in which case it would be counted in this
table under both categories).</p>
<p>The following table summarizes the number of events that could not be
linked to a county that contained at least one of each of these types of
words:</p>
<p>For 2015, here are the <code>cz_name</code> values for the events
that could not be matched to a county and did not include the words
listed above:</p>
<p>For the events listed by forecast zone that could be successfully
matched to a county, here are the geographic distributions in event
counts in 2015:</p>
<p>When using this function, and for event listings generated using this
function, the user may want to hand-check that event listings with names
like “Lake” and “Mountain” in the <code>cz_name</code> column are not
erroneously matched to counties with names like “Lake County” and
“Mountain County”. Code like the following can be used for these checks
(in this case, checking a dataframe of event listings named
<code>z_events_2015</code> that is output from
<code>match_forecast_county</code> and so has <code>fips</code> added
for each event listing, if a match could be found):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z_events_2015</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cz_type</span> <span class="op">==</span> <span class="st">"Z"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cz_name</span>, <span class="va">state</span>, <span class="va">fips</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cz_name <span class="op">=</span> <span class="fu">str_to_title</span><span class="op">(</span><span class="va">cz_name</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">cz_name</span>, <span class="st">"Lake"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">fips</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="impact-measurements">Impact measurements<a class="anchor" aria-label="anchor" href="#impact-measurements"></a>
</h3>
<p>The “Details” datasets for each year include six measurements of the
impacts of each event:</p>
<ul>
<li><code>DEATHS_DIRECT</code></li>
<li><code>DEATHS_INDIRECT</code></li>
<li><code>INJURIES_DIRECT</code></li>
<li><code>INJURIES_INDIRECT</code></li>
<li><code>DAMAGE_PROPERTY</code></li>
<li><code>DAMAGE_CROPS</code></li>
</ul>
<p>Many of the impact values are given using abbreviations for amounts.
For example, this listing for a tornado gives the property damage as
“5.00K”:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">county_events_2015</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">event_id</span> <span class="op">==</span> <span class="st">"582970"</span><span class="op">)</span></span></code></pre></div>
<p>Therefore, the <code>noaastormevents</code> package uses a function
to pull out these abbreviations and convert associated impact values to
numeric values (e.g., 5000 for “5.00K”). The conversions conducted
are:</p>
<ul>
<li>“K” = 1,000</li>
<li>“M” = 1,000,000</li>
<li>“B” = 1,000,000,000</li>
<li>“T” = 1,000,000,000,000</li>
</ul>
<p>This is done by the function <code>parse_damage</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parse_damage</span></span></code></pre></div>
<p>Usually, it seems that the cost per events within an episode do not
overlap, so that the costs from all events in an episode can be summed
to generate a total damage cost. While in some cases, different event
listings within the same county in the same episode have the same damage
cost, it often seems that the total cost was divided in these cases
across events, as in this case, where the total estimated cost of
$6,186,909 in the county (see the narratives) was spread evenly over the
two event listings:</p>
<p>However, there are a few cases where it appears that costs might be
duplicated over different events within the same episode in a county.
For example, in the following listing, it looks like the total estimated
damage cost of $1.7 million (see that narrative) is repeated over the
two listed events, which would mean that adding damages across events in
the episode would lead to a county damage cost of twice the true
amount.</p>
<p>Of the times when a county had two or more events as part of the same
episode in 2015, in 3,136 (87%) cases the damage costs were not
identical across the event listings for the county and episode, while in
452 cases (13%) the cost listings were identical across event listings
(as shown in the cases just given). If using damage cost estimates for
research, it may be wise to hand-check for cases where damage cost
estimates are duplicated across different events in a way that prevents
summing across events to get the cumulative episode total cost.</p>
<p>When costs were summed over all event and county listings in an
episode, here are the ten episodes in the 2015 dataset with the highest
total damage costs (combining property and crop damage):</p>
<p>Here is a table of the total number of events with non-zero damage
(either for property damage or crop damage), the total damage costs
across all events of that type in 2015, and the median and maximum
damage per event for events of that type with non-zero damage costs.
Event types are ordered by total damage costs summed across all
events.</p>
<p>The following graph shows the distribution of events between those
with listed damage costs greater than $0 and those without.</p>
<p>The following figure shows the top 50 episodes in terms of damages
(property and crop damage combined) in 2015:</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Brooke Anderson, Ziyu Chen, Therese Kondash, Jordan Robinson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
